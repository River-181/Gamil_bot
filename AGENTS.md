# AGENTS.md

## 1) 다중 에이전트 협업 규칙
- 변경 제안자는 `gmail-consultant`, `gmail-operator`, `gmail-auditor` 퍼소나를 명시한다.
- 모든 구조 변경은 정책 문서(`README`, `docs/strategy_v3.md`, `config/*.json`)를 기준으로 결정한다.
- 같은 파일을 같은 세션에서 반복 수정할 때는 이전 변경 의도와 충돌 여부를 확인한다.

## 2) 승인 기준
- **낮은 위험 변경**: 문서 보강, 설명 보완, 주석 추가 → 제안 즉시 반영 가능
- **중간 위험 변경**: 라벨/필터 규칙 추가·삭제, 충돌 규칙 변경 → 동시 합의 후 반영
- **높은 위험 변경**: MCP auth 정책 변경, hook 실행 규칙 변경, 토큰/보안 항목 명세 변경 → 사용자 승인 필수

## 3) 금지 / 제한
- 비밀값 hard-code 금지
- `tests`의 실행 산출물 없는 상태에서 실제 Gmail 변경 동작을 주장하지 않는다.
- 임시 스크립트라도 로그에 토큰/헤더/ID 토큰을 그대로 남기지 않는다.
- 실 운영 적용 이전 단계에서 `--plan-only` 또는 `--dry-run` 정책을 생략하지 않는다.

## 4) 품질 기준
- 라벨 총 수는 15개 이하 유지.
- 필터 우선순위는 숫자 오름차순(작은 숫자 우선).
- 동일 메시지 다중 매칭 시 `mutual_exclusive_group` 또는 `conflict_with`를 통해 상향/우선순위 결정한다.
- 정책 변경은 `tests/plans/plan_checklist.md`에 트래킹된다.

## 5) 불필요 작업 억제
- 단계 미달성 변경 요청(운영 미연결 상태에서 외부 자동화 구현)은 보류한다.
- 다음 턴의 실행 계획이 없는 경우, 문서 정합성 확보 작업을 우선한다.

